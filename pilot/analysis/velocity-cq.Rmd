---
title: "Velocity and Closed Quotient"
author: "Stefano Coretta"
date: \today
output: 
  pdf_document: 
    fig_caption: yes
    fig_height: 3.5
    fig_width: 5
    latex_engine: xelatex
    number_sections: yes
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath("../../"))
library(purrr)
library(readr)
library(tidyr)
library(dplyr)
library(ggplot2)
theme_set(theme_bw())
library(stringr)
```

# Data import

```{r read-files}
columns <- c(
    "speaker",
    "time",
    "rel.time",
    "rec.date",
    "prompt",
    "label",
    "TT.displacement.sm",
    "TT.velocity",
    "TT.velocity.abs",
    "TD.displacement.sm",
    "TD.velocity",
    "TD.velocity.abs"
    )

velocity <- list.files(path = "./pilot/results",
                   pattern = "*-velocity.csv",
                   full.names = TRUE) %>%
    map_df(~read_tsv(., col_names = columns, na = "*"))

languages <- read_csv("./pilot/stimuli/languages.csv")
words <- read_csv("./pilot/stimuli/nonce.csv")

velocity <- velocity %>%
    mutate(word = word(prompt, 2)) %>%
    left_join(y = languages) %>%
    left_join(y = words) %>%
    mutate_if(is.character, as.factor)

velocity.coronal <- filter(velocity, c2place == "coronal")
velocity.velar <- filter(velocity, c2place == "velar")
```

# Velocity plots

```{r coronal-velocity-plot}
ggplot(velocity.coronal, aes(rel.time, TT.velocity.abs)) +
    geom_point(alpha = 0.2) +
    facet_grid(vowel ~ c2phonation)
```

```{r velar-velocity-plot}
ggplot(velocity.velar, aes(rel.time, TD.velocity.abs)) +
    geom_point(alpha = 0.2) +
    facet_grid(vowel ~ c2phonation)
```
