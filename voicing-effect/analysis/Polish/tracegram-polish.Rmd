---
title: "Polish tracegrams"
author: "Stefano Coretta"
date: "22/11/2017"
output: 
  html_document: 
    highlight: tango
    number_sections: yes
    theme: paper
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
knitr::opts_knit$set(root.dir = normalizePath("../../../"))
library(tidyverse)
theme_set(theme_bw())
```

# Data import

```{r import}
languages <- read_csv("./voicing-effect/stimuli/languages.csv")
words <- read_csv("./voicing-effect/stimuli/nonce.csv")

degg_pl <- list.files(path = "./voicing-effect/results/egg",
                   pattern = "*-degg-tracing.csv",
                   full.names = TRUE) %>%
    map_df(~read_csv(.)) %>%
    left_join(y = languages) %>%
    filter(language == "polish") %>%
    left_join(y = words) %>%
    filter(c1phonation == "voiceless") %>%
    mutate_if(is.character, as.factor) %>%
    mutate(
        c2phonation_o = ordered(c2phonation, levels = c("voiceless", "voiced")),
        closed_quotient = minimum - maximum
    )
```

# Data exploration

Compared to Italian, there's more variation. It could be an artefact of the new algorith, so I will need to check.

```{r tracegram-point}
degg_pl %>%
ggplot(aes(x = proportion, colour = c2phonation_o)) +
    facet_grid(. ~ language + speaker) +
    geom_point(aes(y = maximum), alpha = 0.5) +
    geom_point(aes(y = minimum), alpha = 0.5) +
    xlab("proportion of vowel duration") +
    ylab("proportion of glottal period") +
    xlim(0.1, 0.9) +
    scale_color_discrete(name = "C2 voicing")
```

There is an increase in the dEGG maximum for voiceless stops in PL02, 03, 05. PL04 does not show this pattern. Moreover, PL05 seems to have the biggest difference in dEGG maximum in the voiceless/voiced context. Recall from the JPhon paper that PL05 is also the speaker with the strongest effect of voicing.

```{r tracegram-smooth}
degg_pl %>%
ggplot(aes(x = proportion, colour = c2phonation_o)) +
    facet_grid(. ~ language + speaker) +
    geom_smooth(aes(y = maximum), size = 0.5, alpha = 0.2) +
    geom_smooth(aes(y = minimum), size = 0.5, alpha = 0.2) +
    xlab("proportion of vowel duration") +
    ylab("proportion of glottal period") +
    xlim(0.1, 0.9) +
    scale_color_discrete(name = "C2 voicing")
```

```{r tracegram-point-time}
degg_pl %>%
ggplot(aes(x = rel.time, colour = c2phonation_o)) +
    facet_grid(. ~ language + speaker) +
    geom_point(aes(y = maximum), alpha = 0.5) +
    geom_point(aes(y = minimum), alpha = 0.5) +
    xlab("vowel duration") +
    ylab("proportion of glottal period") +
    scale_color_discrete(name = "C2 voicing")
```

```{r tracegram-smooth-time}
degg_pl %>%
ggplot(aes(x = rel.time, colour = c2phonation_o)) +
    facet_grid(. ~ language + speaker) +
    geom_smooth(aes(y = maximum), size = 0.5, alpha = 0.2) +
    geom_smooth(aes(y = minimum), size = 0.5, alpha = 0.2) +
    xlab("vowel duration") +
    ylab("proportion of glottal period") +
    scale_color_discrete(name = "C2 voicing")
```

```{r cq-trajectory}
degg_pl %>%
ggplot(aes(x = rel.time, colour = c2phonation_o)) +
    facet_grid(. ~ language + speaker) +
    geom_smooth(aes(y = closed_quotient)) +
    xlab("vowel duration") +
    ylab("proportion of glottal period") +
    scale_color_discrete(name = "C2 voicing")
```

If we look at the close quotient (CQ = dEGG minimum - dEGG maximum), it seems that again PL05 shows the biggest difference.
The CQ is problematic I think but it can still tell us something. I am working on it so I'll tell you more about it after Xmas.

```{r cq-boxplot}
degg_pl %>%
    group_by(speaker, c2phonation_o, date) %>%
    summarise(closed_quotient = mean(closed_quotient)) %>%
ggplot(aes(x = c2phonation_o, y = closed_quotient)) +
    facet_grid(. ~ speaker) +
    geom_boxplot() +
    xlab("C2 phonation") +
    ylab("closed quotient")
```
