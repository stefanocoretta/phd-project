---
title: "Tongue root"
author: "Stefano Coretta"
date: "19/08/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
theme_set(theme_minimal())
data("kinematics_series", "kinematics", package = "coretta2018itapol")
kinematics_series <- kinematics_series %>%
  filter(c1_phonation == "voiceless") %>%
  mutate(
    c2_phonation = factor(c2_phonation, levels = c("voiceless", "voiced"))
  )
kine_s <- kinematics_series %>%
  filter(TR_displacement_sm > 10, proportion < 1) %>%
  mutate(trp = -TR_displacement_sm + max(TR_displacement_sm))
```

# Data visualisation

```{r n-trajectories}
length(table(kine_s$rec_date))
```

```{r trp-point}
kinematics_series %>%
  ggplot(aes(proportion, -TR_displacement_sm)) +
  geom_point(alpha = 0.1)
```

```{r points-filtered}
kine_s %>%
  ggplot(aes(proportion, trp)) +
  geom_point(alpha = 0.1)
```

```{r points-voicing}
kine_s %>%
  ggplot(aes(proportion, trp, colour = c2_phonation)) +
  geom_point(alpha = 0.1)
```

```{r smooth-voicing}
kine_s %>%
  ggplot(aes(proportion, trp, colour = c2_phonation)) +
  geom_point(alpha = 0.1) +
  geom_smooth()
```

```{r smooth-voicing-2}
kine_s %>%
  ggplot(aes(proportion, trp, colour = c2_phonation)) +
  geom_smooth()
```

The smooths show advancement of the tongue root of 1.5 mm in vowels followed by voiced stops and a 1 mm advancement in vowels followed by voiceless stops.

```{r smooths-facet}
kine_s %>%
  ggplot(aes(proportion, trp, colour = c2_phonation)) +
  geom_smooth(method = "gam", formula = y ~ s(x, k = 10)) +
  facet_grid(vowel ~ c2_place)
```

```{r trajectories}
kine_s %>%
  ggplot(aes(proportion, trp, group = reorder(rec_date, vowel_duration), colour = vowel_duration)) +
  geom_path(alpha = 0.5) +
  scale_colour_distiller(type = "seq", palette = "YlGn") +
  theme_dark()
```

```{r trajectories-facet}
kine_s %>%
  ggplot(aes(proportion, trp, group = reorder(rec_date, vowel_duration), colour = vowel_duration)) +
  geom_path(alpha = 0.5) +
  facet_grid(vowel ~ c2_place) +
  scale_colour_distiller(type = "seq", palette = "YlGn") +
  theme_dark()
```
