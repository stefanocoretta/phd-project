---
title: "Polish durations"
author: "Stefano Coretta"
date: \today
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath("../../../"))
library(tidyverse)
theme_set(theme_bw())
library(lmerTest)
library(effects)
```

# Import data

```{r read-data}
languages <- read_csv("./italian-polish/stimuli/languages.csv")
words <- read_csv("./italian-polish/stimuli/nonce.csv")

vowels <- list.files(path = "italian-polish/results/durations",
                   pattern = "*-vowel-durations.csv",
                   full.names = TRUE) %>%
    map_df(~read_csv(., na = "--undefined--")) %>%
    left_join(y = languages) %>%
    left_join(y = words) %>%
    filter(language == "polish") %>%
    mutate_if(is.character, as.factor) %>%
    mutate(index = as.factor(index))
```

# Data plotting

```{r vowel-hist}
vowels %>%
    ggplot(aes(vowel.duration, fill = c2_phonation)) +
    geom_histogram()
```

```{r vowel-hist}
vowels %>%
    ggplot(aes(vowel.duration, fill = c2_phonation)) +
    geom_histogram() +
    facet_wrap(~ speaker)
```

```{r vowel-density}
vowels %>%
    ggplot(aes(vowel.duration, colour = c2_phonation)) +
    geom_density() +
    facet_wrap(~ speaker)
```


```{r vowel-violin}
vowels %>%
    ggplot(aes(vowel, vowel.duration, colour = c2_phonation)) +
    geom_violin() +
    facet_wrap(~ speaker)
```

```{r vowel-boxplot}
vowels %>%
    ggplot(aes(vowel, vowel.duration, colour = c2_phonation)) +
    geom_boxplot() +
    facet_wrap(~ speaker)
```

```{r}
vowels %>%
    filter(c2_place == "coronal") %>%
    ggplot(aes(vowel, vowel.duration, colour = c2_phonation)) +
    geom_violin() +
    facet_wrap(~ speaker)
```

```{r}
vowels %>%
    filter(c2_place == "velar") %>%
    ggplot(aes(vowel, vowel.duration, colour = c2_phonation)) +
    geom_violin() +
    facet_wrap(~ speaker)
```

Count of available closure duration measurements. FALSE = missing.

```{r}
table(!is.na(vowels$closure.duration), vowels$c2_place, vowels$c2_phonation)
```


```{r}
vowels %>%
    ggplot(aes(closure.duration, vowel.duration, colour = c2_phonation)) +
    geom_point(alpha = 0.5) +
    geom_smooth(method = "lm")
```

```{r}
vowels %>%
    ggplot(aes(closure.duration, vowel.duration, colour = c2_phonation)) +
    geom_point(alpha = 0.5) +
    geom_smooth(method = "lm") +
    facet_wrap(~ speaker)
```

```{r}
vowels %>%
    ggplot(aes(word.duration, vowel.duration, colour = c2_phonation)) +
    geom_point(alpha = 0.5) +
    geom_smooth(method = "lm")
```

```{r}
vowels %>%
    ggplot(aes(word.duration, vowel.duration, colour = c2_phonation)) +
    geom_point(alpha = 0.5) +
    geom_smooth(method = "lm") +
    facet_wrap(~ speaker)
```


# Statistical analysis


