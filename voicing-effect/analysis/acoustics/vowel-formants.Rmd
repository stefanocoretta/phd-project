---
title: "Vowel formants and fundamental frequency"
author: "Stefano Coretta"
date: "12/02/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("../../../"))
library(tidyverse)
theme_set(theme_minimal())
```

# Data import

```{r}
speakers <- read_csv("./voicing-effect/data/datasets/speakers.csv")
words <- read_csv("./voicing-effect/data/datasets/stimuli.csv")

formants <- list.files(
  path = "voicing-effect/data/datasets/acoustics/",
  pattern = "*-formants.csv",
  full.names = TRUE
) %>%
  map_df(~read_csv(., na = "--undefined--")) %>%
  left_join(y = speakers) %>%
  left_join(y = words) %>%
  mutate_if(is.character, as.factor)
```

# Exploration

```{r}
formants %>%
  filter(language == "italian") %>%
  ggplot(aes(time, f1, colour = c2_phonation)) +
  geom_smooth() +
  facet_grid(c2_place ~ vowel)
```

```{r}
formants %>%
  filter(language == "italian") %>%
  ggplot(aes(time, f2, colour = c2_phonation)) +
  geom_smooth() +
  facet_grid(c2_place ~ vowel)
```

```{r}
formants %>%
  filter(language == "italian") %>%
  ggplot(aes(time, f3, colour = c2_phonation)) +
  geom_smooth() +
  facet_grid(c2_place ~ vowel)
```

```{r}
formants %>%
  filter(language == "italian") %>%
  ggplot(aes(x = time, colour = c2_phonation)) +
  geom_smooth(aes(y = f1)) +
  geom_smooth(aes(y = f2)) +
  facet_grid(c2_place ~ vowel)
```

```{r}
formants %>%
  filter(language == "polish") %>%
  ggplot(aes(x = time, colour = c2_phonation)) +
  geom_smooth(aes(y = f1)) +
  geom_smooth(aes(y = f2)) +
  facet_grid(. ~ vowel)
```

```{r}
for (i in 1:9) {
  print(formants %>%
  filter(time == i, language == "italian", vowel != "u") %>%
  ggplot(aes(f2, f1, colour = c2_phonation)) +
  geom_point() +
  facet_grid(c2_place ~ vowel) +
  scale_x_reverse(lim = c(max(formants$f2), min(formants$f2))) +
  scale_y_reverse(lim = c(max(formants$f1), min(formants$f1)))
  )
}
```

```{r}
for (i in 1:9) {
  print(formants %>%
  filter(time == i, language == "polish", vowel != "u") %>%
  ggplot(aes(f2, f1, colour = c2_phonation)) +
  geom_point() +
  facet_grid(c2_place ~ vowel) +
  scale_x_reverse(lim = c(max(formants$f2), min(formants$f2))) +
  scale_y_reverse(lim = c(max(formants$f1), min(formants$f1)))
  )
}
```
