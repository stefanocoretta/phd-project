---
title: "Release to release"
author: "Stefano Coretta"
date: "14/11/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("../"))
library(tidyverse)
theme_set(theme_minimal())
library(coretta2018itaegg)
library(lme4)
library(lmerTest)
library(sjPlot)

data("ita_egg")
ita_egg <- ita_egg %>%
  mutate(
    vowel = factor(vowel, levels = c("i", "e", "a", "o", "u")),
    height = factor(height, levels = c("low", "mid-low", "mid-high", "high")),
    c1_place = factor(c1_place, levels = c("labial", "coronal", "velar")),
    c2_place = factor(c2_place, levels = c("labial", "coronal", "velar")),
    rel_rel = (c2_rel - c1_rel) * 1000
  ) %>%
  mutate_if(is.character, as.factor)
```

# Plots

```{r rr}
ita_egg %>%
  ggplot(aes(rel_rel)) +
  geom_density() +
  geom_rug()
```


```{r rr-vow}
ita_egg %>%
  ggplot(aes(rel_rel, fill = vowel)) +
  geom_density(alpha = 0.5, size = 0) +
  geom_rug()
```

```{r rr-vow-box}
ita_egg %>%
  ggplot(aes(vowel, rel_rel, fill = height)) +
  geom_boxplot()
```

```{r rr-place-2}
ita_egg %>%
  ggplot(aes(rel_rel, fill = c2_place)) +
  geom_density(alpha = 0.5, size = 0) +
  geom_rug() +
  facet_grid(c1_place ~ .)
```

```{r rr-place-1}
ita_egg %>%
  ggplot(aes(rel_rel, fill = c1_place)) +
  geom_density(alpha = 0.5, size = 0) +
  geom_rug() +
  facet_grid(c2_place ~ .)
```

```{r rr-place-2-box}
ita_egg %>%
  ggplot(aes(c2_place, rel_rel, fill = c2_place)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.05)
```

```{r rr-place-1-box}
ita_egg %>%
  ggplot(aes(c1_place, rel_rel, fill = c1_place)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.05)
```

Could it be that velar consonants had multiple releases and by chosing the first one the interval is longer?

```{r rr-rate}
ita_egg %>%
  ggplot(aes(speech_rate,  rel_rel)) +
  geom_point(alpha = 0.5)
```

