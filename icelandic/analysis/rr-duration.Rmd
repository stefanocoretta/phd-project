---
title: "Icelandic data"
author: "Stefano Coretta"
date: "29/07/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("../../"))
library(tidyverse)
theme_set(theme_bw())
```

# Read data

```{r read-data, message=FALSE}
words <- read_csv("./icelandic/data/datasets/words.csv")

is_durations <- read_csv("./icelandic/data/datasets/measurements.csv") %>%
  inner_join(y = words) %>%
  mutate(
    aspiration = factor(aspiration, levels = c("non-aspirated", "aspirated")),
    syllables = factor(syllables, levels = c("mono", "di")),
    syl_rate = ifelse(
      syllables == "mono",
      5 / sentence_duration,
      6 / sentence_duration
    )
  ) %>%
  mutate_if(is.character, as.factor)
```

# Summaries

```{r count}
is_durations %>%
  ggplot(aes(sequence, fill = aspiration)) +
  geom_bar(position = position_dodge()) +
  facet_grid(syllables ~ .)
```

```{r count-x-stop}
is_durations %>%
  filter(x_stop == "yes") %>%
  ggplot(aes(sequence, fill = aspiration)) +
  geom_bar(position = position_dodge()) +
  facet_grid(syllables ~ .)
```

# Descriptive statistics

```{r}
is_durations %>%
  filter(x_stop == "yes") %>%
  ggplot(aes(rr, fill = aspiration)) +
  geom_density(alpha = 0.5) +
  facet_grid(syllables ~ sequence) +
  geom_rug()
```

```{r}
is_durations %>%
  filter(x_stop == "yes") %>%
  ggplot(aes(aspiration, rr)) +
  geom_boxplot() +
  facet_grid(syllables ~ sequence)
```

```{r}
is_durations %>%
  filter(x_stop == "yes") %>%
  ggplot(aes(aspiration, rr)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.3, width = 0.3) +
  facet_grid(syllables ~ sequence)
```

```{r}
is_durations %>%
  filter(x_stop == "yes", c1_manner == "stop") %>%
  ggplot(aes(aspiration, rr)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.3, width = 0.3) +
  facet_grid(syllables ~ sequence)
```

