---
title: "A time-aligned account of lingual and laryngeal gestures using ultrasound tongue imaging (UTI) and electroglottography (EGG)"
author: "Stefano Coretta"
date: "\\today"
output:
  bookdown::pdf_document2:
    citation_package: natbib
    latex_engine: xelatex
    number_sections: yes
    toc: yes
papersize: A4
fontsize: 11pt
mainfont: Brill
mainfontoptions: Numbers=Lining
bibliography: linguistics.bib
biblio-style: unified.bst
header-includes:
- \frenchspacing
- \usepackage{cleveref}
- \setcitestyle{aysep={},notesep={:},citesep={,}}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

This document is a technical report of the methodology specifically developed for this PhD project.
The results of a pilot study testing the methodology will also be discussed.
Extracts of this report will be included in the dissertation as part of the "Literature review" and "Methodology" chapters.

# Purpose

The combination of techniques described in the following sections allows a synchronous mapping of lingual gestures and phonation during speech.
Such methodology enables a time-aligned account of the movements of the tongue and the concomitant configuration of the glottis that characterises phonation.
These techniques employ ultrasound tongue imaging (UTI) and electroglottography (EGG) for the simultaneous acquisition of articulatory data from, respectively, the oral cavity and the glottis.

## Ultrasound tongue imaging

Ultrasound tongue imaging (UTI) uses ultrasonography for charting the movements of the tongue into a two-dimensional image.
In medical sonography, ultrasound waves (sound waves at high frequencies, ranging between 2 and 14 MHz) are emitted from a probe in a fan-like manner, and travel through organic tissue (such as skin and muscles).
When the surface of a material with different density is hit, the ultrasound waves are partially reflected, and such "echo" is registered by the probe.
These echoes can then be plotted on a two-dimensional graph, where different densities are represented by different shades (higher densities are brighter, while lower densities are darker).
The graph, or ultrasound image, will show high density surfaces as very bright lines, surrounded by darker areas (\Cref{f:uti}).
By positioning the ultrasound probe in contact with the submental triangle (the surface below the chin), sagittally oriented, it is possible to infer the cross-sectional profile of the tongue, which appears as a bright line in the resulting ultrasound image.

![An ultrasound image of the tongue.\label{f:uti}](../graphics/uti.png){ width=60% }

## Electroglottography

Electroglottography [@fabre1957] is a technique that measures the size of contact between the vocal folds (the Vocal Folds Contact Area, VFCA).
A high frequency low voltage electrical current is sent through two electrodes which are in contact with the surface of the neck, one on each side of the thyroid cartilage (\Cref{f:egg-setup}).
The impedance of the current is directly correlated with VFCA, while its amplitude is inversely correlated [@titze1990].
Thus, impedance increases with lower VFCA and decreases with higher VFCA.
Conversely, amplitude decreases when the VFCA increases and it increases when the VFCA decreases.
The EGG unit registers changes in impedance and it converts it in amplitude.
Its output is a synchronised stereo recording which contains the EGG signal from the electrodes in right channel and the audio signal from the microphone in the left channel.

![A schematic representation of the electroglottograph. The transversal section of the neck at the level of the glottis is represented: the effect of the glottis on the electric field are shown on the left for the open glottis and on the right figure for the closed glottis.\label{f:egg-setup}](../graphics/egg-setup.pdf){ width=80% }

# Methodology

This section describes the equipment setup, and the procedure for the acquisition, synchronisation, and analysis of the UTI and EGG data.
Statistical analysis will be the subject of \Cref{s:stats}.

## Equipment setup {#s:setup}

![Equipment set-up scheme.\label{f:setup}](../graphics/setup.pdf){ width=80% }

\Cref{f:setup} shows the equipment set-up employed in the study.
The left part of the figure shows the ultrasound set-up, while the EGG set-up is shown on the right.
Two separate laptops are used for the acquisition of the ultrasound and EGG recordings.
The ultrasound unit is plugged into one laptop.
A P-Stretch unit (used for signal synchronisation) and the ultrasound probe are directly connected to the ultrasound unit.
The P-Stretch unit and a microphone feed a pre-amplifier system, which is plugged into the ultrasound laptop.
A second microphone and the electrodes are connected to the EGG unit, which is plugged into the second laptop.
A TELEMED Echo Blaster 128 system is used for ultrasonography and a Glottal Enterprises EG2-PCX2 unit for EGG.
The subject wears a headset (not shown in \Cref{f:setup}) which holds the ultrasound probe in position (allowing free head movement) and a velcro strap with the EGG electrodes, located on each side of the thyroid cartilage, at the level of the glottis.
The microphones are clipped to the headset on either side, at identical height.

## Acquisition of ultrasound and EGG

Ultrasound and EGG inputs are acquired and recorded in separate laptops by means of, respectively, Articulate Assistant Advanced [AAA,@articulate2011] and Praat [@boersma2016].

## Ultrasound and EGG synchronisation

Since the signals from the ultrasound machine and the electroglottograph are recorded simultaneously but separately, data from both machines need to be synchronised after acquisition.
Synchronisation is achieved through the cross-correlation of the audio signals from both sources [@grimaldi2008].
This method creates a sound file from two audio files which is the cross-correlation of the original files (\Cref{f:cross-correlation}).
The interval between the start of the cross-correlated sound file and the time of maximum amplitude is equal to the lag between the two original files.
Syncing of the original sound files is achieved by trimming the longer sound from its start by the same amount as the lag.
A measure taken at any particular time in the ultrasound source can thus be related to a measure taken at that same time in the EGG source.

![Synchronisation of two sounds by cross-correlation. \label{f:cross-correlation}](../graphics/cross-correlation.pdf){ width=80% }

## Analysis of ultrasound data

The ultrasound data is analysed with the same programme used for recording [@articulate2011].
The tracking of the tongue contours is performed using a built-in automatic spline tracker.
The splines as resulting from the automatic tracking are then checked and corrected manually if necessary.
Velocity measures are subsequently calculated based on tongue displacement along two fan lines (one for the tongue tip and one for the tongue dorsum).
Appropriate fan line selection is achieved by inspecting the standard deviation of tongue displacement on a few fan lines which lie on relevant portions of the tongue (front for the tongue tip and back-centre for tongue dorsum).
The fan line of each respective tongue portion with the largest standard deviation is chosen and the velocity of tongue displacement along that line is calculated.
Finally, four gestural landmarks (the onset and offset of the consonantal gesture and of its nucleus) are identified from the absolute velocity values using the method described in the following paragraph [@strycharczuk2015].

A single consonantal gesture is normally constituted by a closing phase that starts during the preceding vowel, a moment of maximum constriction during the consonant closure, and an opening phase that terminates during the following vowel.
The time of maximum constriction corresponds to the time of the minimum absolute velocity within the interval of the consonant closure (\Cref{f:velocity}).
The velocity minimum is preceded and followed by two velocity maxima.
The onset and offset of the nucleus of the consonantal gesture then correspond to the time where the absolute velocity reaches the 20% of the peak velocity [@kroos1997; @gafos2010a; @gafos2010], respectively before and after the maximum constriction.
Finally, the gesture onset and offset are defined as the time where the peak velocity preceding and following the peaks reaches the 20% of the local peak velocity.
The time and spline coordinates at each of the four gestural landmarks are then extracted for statistical analysis.

![Identification of the gestural landmarks from the absolute tongue velocity profile (`gons` = gesture onset, `nons` = nucleus onset, `max` = maximum constriction, `noff` = nucleus offset, `goff` = gesture offset).\label{f:velocity}](../graphics/velocity.pdf){ width=80% }

## Analysis of EGG data {#s:tracegram}

Previous studies have shown that the mathematical first derivative of the EGG signal helps determine the moments of glottal closure and opening in each vibration cycle, or glottal period [@henrich2004;@henrich2005].
The first derivative of a signal is the velocity of the signal, in other words how fast the signal changes in time.
The time of maximum velocity in the first derivative of the EGG signal (dEGG) roughly corresponds to the moment of glottal closure.
The time of minimum velocity corresponds to the moment of glottal opening.
Thus, glottal closure and opening for each glottal period can be extracted from the dEGG.

[say that shorter closed phase correlates with glottal spread]: #

@herbst2010 describe a new technique, called electroglottographic wavegram, which displays the variations in the EGG and dEGG signals in a single graph.
A wavegram contains temporal information on the *x* and *y* axis, while changes in the VFCA are rendered as different colour intensities on the *z* axis.

The extraction of dEGG maxima and minima has been implemented in this study using the PRAAT scripting language.
The algorithm consists of the following stages:

1. detection of the glottal periods
1. calculation of the dEGG
1. extraction of absolute dEGG maximum (dEGG~max~) and minimum (dEGG~min~) for each glottal period
1. calculation of dEGG~max~ and dEGG~min~ relative to the glottal period

It is conventional to define a glottal period as the time between two consecutive moments of glottal closure, i.e. two consecutive dEGG maxima.
However, since the maxima need to be identified in the first place, an arbitrary definition of glottal period is instead used.
Glottal periods correspond to the intervals between two consecutive EGG minima [cf. ...].
First, the EGG signal is band-pass filtered (40Hz-10KHz) and smoothing is applied.
A weighted sliding-average smoothing method (triangular smooth) is used, with smooth width *m* = 11.
EGG minima are thus extracted from the smoothed EGG signal.
The interval between any two consecutive minima constitutes a glottal period.

The dEGG is calculated with the formula $x_n' =  x_{n+1} - x_n$, where $x_n$ is the value of the EGG signal at the time n.
After calculation, the resulting dEGG is smoothed with the same method as before (triangular smooth, *m* = 11).
The algorithm then searches for dEGG maxima and minima within each glottal period (defined as two consecutive EGG minima).
Finally, relative dEGG~max~ and dEGG~min~ are calculated as proportions of the respective glottal period.
The resulting values are between 0 (beginning of period) and 1 (end of period).

As @herbst2010 note, the wavegram technique has the limitation of not being suitable for quantitative analysis.
A new visualisation technique, based on wavegrams, is introduced here: electroglottographic tracegram.
The tracegram method, even if it reduces the displayed dimensions, allows a statistical assessment of the varying dEGG~max~ and dEGG~min~, thus constituting a partial improvement over wavegrams.
After the calculation of the relative dEGG~max~ and dEGG~min~, these values are  plotted in a graph on the *y* axis at each time point which corresponds to the beginning of a glottal period.
Since the values are restricted between 0 and 1 (being proportions), changes in glottal period (which corresponds to changes in fundamental frequency and hence pitch) are controlled for.
The resulting graph, the tracegram, shows the traces of dEGG~max~ and dEGG~min~ as they change in time, in a way similar to the display of pitch contours.

# Statistical analysis {#s:stats}

Traditionally, differences in tongue contours has been assessed using Smoothing Spline ANOVA (SSANOVA) models [@gu2013;@davidson2006].
More recently, generalised additive models (GAMs) have been applied to dynamic linguistic data including a space or time dimension [@wood2006;@soskuthy2017].
GAMs are considered to be a more conservative type of statistical model than SSANOVA, thus reducing the probability of getting false positive results.
I am thus currently testing the application of GAMs on UTI and EGG data.
Data post-processing and statistical analysis is performed in R [@r-core-team2015].

# Pilot study

I ran a pilot study to verify the performance of the methodology.
Two speakers of Italian (2 males) and two speakers of Polish (1 female, 1 male) were recorded using the setup described in \Cref{s:setup}.
The target words were of the form C\textsubscript{1}V\textsubscript{1}C\textsubscript{2}V\textsubscript{1}, where C\textsubscript{1} = /p/, V\textsubscript{1} = /a, o, u/, C\textsubscript{2} = /t, d, k, g/. The words were embedded in prosodically similar sentences (Italian *Dico X lentamente* 'I say X slowly', and Polish *Mówię X teraz* 'I say X now').

## Results

![Tongue contour at maximum constriction of coronal consonants in Italian and Polish.\label{f:coronal}](../graphics/coronal.pdf){ width=90% }


\Cref{f:coronal} shows the tongue contours of the speakers of Italian and Polish.
Only the contours at maximum closure of coronal consonants are plotted, separately for each vowel (rows) and speaker (columns).
The root of the tongue is on the left of each graph, while the tip is on the right.
The contours of the anterior part of the tongue in voiced (red lines) and voiceless stops (blue lines) overlap both in Italian and Polish.
This indicates that the the sagittal shape of the tongue at maximum constriction is not affected by the voicing of the consonant.
However, the tongue root seems to be advanced in voiced stops (red lines) compared to voiceless stops (blue lines) in Italian, but not in Polish.
According to a generalised additive mixed effects model fitted on the Italian and Polish data, the tongue root was significantly advanced in voiced stops in Italian, while there was no significant difference in Polish (\Cref{f:it-pl}).

![Tongue contour in voiceless and voiced stops at maximum constriction in Italian (left) and Polish (right). When the confidence intervals of the difference smooth (grey) do not cross 0 on the y-axis, they indicate a significant difference (red line on the x-axis).\label{f:it-pl}](../graphics/it-pl.pdf){ width=90% }

The analysis of the EGG data is underway, although, as derived from the visual inspection of the data, it seems that both Italian and Polish voiceless stops entail earlier glottal spread, reflected in the tracegram of these stops, shown in \Cref{f:tracegram}.
The dEGG maximum starts raising at around 60% of the vowel in Italian and Polish if the vowel is followed by voiceless stops.
A raised dEGG maximum during the last portion of the vowel indicates that glottal spreading (which is the configuration of the vocal folds during the production of voiceless stops) is initiated even before consonant closure is achieved.
On the contrary, there seems to be no significant increase in the dEGG maximum in voiced stops in neither language.

![Tracegram.\label{f:tracegram}](../graphics/tracegram.pdf){ width=80% }

# References
