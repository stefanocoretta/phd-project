---
title: 'Exploratory study on the acoustic and articulatory properties of VC sequences in Italian and Polish'
author: "Stefano Coretta"
date: "05/06/2018"
output:
  pdf_document:
    citation_package: natbib
    fig_height: 3.5
    fig_width: 5
    highlight: tango
    latex_engine: xelatex
    number_sections: yes
fontsize: 12pt
mainfont: FreeSans
bibliography: linguistics.bib
biblio-style: unified.bst
---

```{r setup, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("../../"))
library(tidyverse)
theme_set(theme_light())
cbPalette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7", "#999999")
library(lme4)
library(effects)
library(rticulate)
```

```{r read-data, echo=FALSE, include=FALSE}
speakers <- read_csv("./voicing-effect/data/datasets/speakers.csv")
stimuli <- read_csv("./voicing-effect/data/datasets/stimuli.csv")

duration_raw <- list.files(
  path = "./presentations/2018-labphon/datasets/acoustics/",
  pattern = "*-durations.csv",
  full.names = TRUE
) %>%
  map_df(~read_csv(., na = "--undefined--"))

columns <- c(
  "speaker",
  "seconds",
  "rec_date",
  "prompt",
  "label",
  "TT_displacement_sm",
  "TT_velocity",
  "TT_velocity_abs",
  "TD_displacement_sm",
  "TD_velocity",
  "TD_velocity_abs",
  "TR_displacement_sm",
  "TR_velocity",
  "TR_velocity_abs"
)

duration <- list.files(
  path = "./voicing-effect/data/datasets/ultrasound/",
  pattern = "*-tongue-cart.tsv",
  full.names = TRUE
) %>%
  map_df(~read_aaa(., column_names = columns, format = "wide")) %>%
  select(-(X_1:Y_42)) %>%
  filter(label == "closure_") %>%
  mutate(word = word(prompt, 2)) %>%
  left_join(y = speakers) %>%
  left_join(y = stimuli) %>%
  left_join(y = duration_raw) %>%
  filter(c1_phonation == "voiceless") %>%
  droplevels() %>%
  mutate(
    c2_phonation = factor(c2_phonation, levels = c("voiceless", "voiced")),
    language = recode(language, italian = "Italian", polish = "Polish"),
    syl_rate = ifelse(
      language == "Italian",
      8 / sentence_duration,
      6 / sentence_duration
    )
  ) %>%
  mutate_if(is.character, as.factor) %>%
  # filter clear outlier
  filter(TR_displacement_sm > 40) %>%
  group_by(speaker) %>%
  mutate(
    vowel_duration_z = scale(vowel_duration),
    tongue_root = -TR_displacement_sm,
    tongue_root_z = scale(tongue_root)
  ) %>%
  ungroup() %>%
  filter(tongue_root_z < 3)
```

# Results

This short report discusses a selection of results from an exploratory study concerning the acoustic and articulatory properties of VC sequences in C**VC**V words in Italian and Polish.
The aim of the study was to collect acoustic and articulatory data in relation to the so called 'voicing effect', by which vowels are longer before voiced stops than before voiceless stops.
Synchronised acoustic, ultrasonic, and electroglottographic data was collected from 11 speakers of Italian (5 F, 6 M) and 6 speakers of Polish (3 F, 3 M).
The data collection started in December 2016 and has been completed in May 2018.
All of the data has been now processed for subsequent analysis, which is still ongoing but nearest completion.

The results from the acoustic data will be presented first, with a focus on vowel and consonant closure duration in C1VC2V words as a function of the voicing of C2.
Evidence in support of a durational trade-off account of the voicing effect will be offered.
Next, the articulatory data concerning the position of the tongue root during the production of VC sequences will be discussed.

## Acoustic data

### Vowel duration

In accord with @farnetani1986, @esposito2002, and @nowak2006, Italian and Polish show an effect of consonantal voicing on preceding vowel duration.
Vowel are shorter when followed by voiceless stops, while they are longer when followed by voiced stops.

```{r vow-voi-dur, echo=FALSE}
duration %>%
  ggplot(aes(language, vowel_duration, fill = c2_phonation)) +
  geom_boxplot() +
  scale_fill_manual(name = "C2 voicing", values = cbPalette) +
  labs(
    title = "Vowel duration before voiceless and voiced stops",
    subtitle = "Data from 17 speakers (11 Italian, 6 Polish)",
    x = "Language",
    y = "Vowel duration (ms)"
  )
```

According to linear mixed-effect models (LMER), vowels are about 15 ms longer when followed by voiced stops.
Language does not have a significant effect on vowel duration, neither does an interaction between voicing and language.
However, the identity of the vowel as an effect on vowel duration, a well-known but still poorly understood phenomenon [@esposito2002].
Other things being equal, /a/ is longer then /o/, which is longer than /u/.

```{r vow-dur, echo=FALSE}
duration %>%
  ggplot(aes(vowel, vowel_duration, fill = vowel)) +
  geom_boxplot() +
  scale_fill_manual(name = "Vowel", values = cbPalette) +
  labs(
    title = "Effect of vowel identity on vowel duration",
    x = "Vowel",
    y = "Vowel duration (ms)"
  ) +
  facet_grid(~ language) +
  theme(legend.position = "none")
```

\citet{farnetani1986} reported a 35 ms effect of voicing on vowel duration in Italian, while \citet{nowak2006} gives a 4.5 ms effect for Polish.
These estimates are different from the one found in this study (15), but several factors might have played a role in producing such difference.
For example, \citet{farnetani1986} did not control for speech rate, while speech rate (measured as number of syllables per second) has been included in this analysis.
Differences in the criteria for vowel onset and offset placement might have also contributed to difference in durational measurements.
Even when adding language and an interaction between language and C2 voicing in the model (inclusion that does not improve model fit), the estimate for the voicing effect in Italian increases by 1.5 ms (16.5), but decreases of only 5 ms for Polish (11.5).
In sum, the data from this study does not support a different effect of voicing on vowel duration in Italian and Polish.

### C2 closure duration

The closure duration of voiceless stops is 16 ms longer than that of voiced stops, a pattern known to apply cross-linguistically [@davis1989; @fowler1992].

```{r clos-dur, echo=FALSE}
duration %>%
  ggplot(aes(c2_place, vowel_duration, fill = c2_phonation)) +
  geom_boxplot() +
  scale_fill_manual(name = "C2 voicing", values = cbPalette) +
  labs(
    title = "Closure duration before voiceless and voiced stops",
    x = "C2 place of articulation",
    y = "Closure duration (ms)"
  ) +
  facet_grid(~ language)
```

One of the accounts for explaining the voicing effect relies on the fact that vowel duration and closure duration are inversely correlated [@slis1969].
Vowel are shorter before voiceless stops, which have a longer closure, and, vice versa, vowels are longer before voiced stops, which have a shorter closure.
The correlation between vowel and closure duration holds independently of the voicing of the consonant, such that, within a word, longer vowel duration correlates with shorter closure duration [@sharf1962; @davis1989].
The data of this study shows the same type of correlation, and the inclusion of C2 voicing does not improve the model fit (meaning that the correlation holds independent of C2 voicing).

```{r vow-clos-lm, echo=FALSE, include=FALSE}
vow_clos_lm <- lmer(
  vowel_duration ~
    closure_duration +
    syl_rate +
    vowel +
    c2_place +
    (1|speaker) +
    (1|item),
  data = duration,
  REML = FALSE
)
summary(vow_clos_lm)
```

```{r vow-clos-plot, echo=FALSE, warning=FALSE}
as_tibble(effect("closure_duration", vow_clos_lm)) %>%
  ggplot(aes(closure_duration, fit)) +
  geom_rug(
    inherit.aes = FALSE,
    data = duration,
    mapping = aes(x = closure_duration),
    alpha = 0.2
  ) +
  geom_ribbon(
    aes(ymax = upper, ymin = lower),
    fill = cbPalette[2],
    alpha = 0.2
  ) +
  geom_line(colour = cbPalette[2]) +
  labs(
    title = "Correlation between vowel and closure durations",
    x = "Closure duration (ms)",
    y = "Vowel duration (ms)"
  )
```

### Release to Release duration

Based on the correlation between vowel and closure duration, it has been claimed that the voicing effect is the product of a durational trade-off between the duration of the vowel and the duration of the closure of the following consonant.
The trade-off would be brought about by the relative timing of the onset of closure.
An earlier closure onset corresponds to a shorter vowel and a longer closure duration, while a later closure onset produces the opposite pattern, a longer vowel followed by a shorter closure.

The durational trade-off account rests on the assumption that there is an interval within which the trade-off is implemented.
For the account to work, said interval should not be affected by the voicing of the stop, in the sense that the duration of the interval should be invariant.
To the best of my knowledge, previous studies failed to find such invariant interval.
Although the syllable and word have been proposed as the invariant interval within which the trade-off happens, both units present problems when confronted with empirical data.

The data collected in this exploratory study brings new evidence in support of the trade-off account, by offering a suitable invariant interval: the Release to Release interval (RR), i.e. the interval between the release of C1 and the release of C2 in C1VC2V words.
The RR duration is nor affected by the voicing of C2, such that the duration is theoretically the same in C1VC2V words, where C2 is either voiceless of voiced (for example, *pata* vs. *pata*).
According to an LMER, voicing of C2 does not have an effect on RR duration.
On the other hand, vowel identity and C2 place of articulation have an effect in Italian but not in Polish.
Only in Italian, /u/ and velar stops have a shorter RR compared to /a, o/ and coronal consonants, with similar estimates (-11.5 ms).

```{r rr-box-lang, echo=FALSE, warning=FALSE}
duration %>%
  # group_by(speaker) %>%
  # mutate(rel_rel = scale(rel_rel)) %>%
  ggplot(aes(c2_phonation, rel_rel, fill = c2_phonation)) +
  geom_boxplot() +
  facet_grid(~ language) +
  scale_fill_manual(name = "C2 voicing", values = cbPalette) +
  labs(
    x = "C2 voicing",
    y = "Release to Release duration (ms)"
  ) +
  theme(legend.position = "none")
```

```{r rr-lm, echo=FALSE, include=FALSE}
rr_lm <- lmer(
  rel_rel ~
    vowel +
    c2_place +
    language +
    c2_place:language +
    vowel:language +
    syl_rate +
    (1|speaker) +
    (1|item),
  data = duration,
  REML = FALSE
)

summary(rr_lm)
```

It thus appears that the durational difference of vowels as a function of the voicing of following consonants is a by-product of the invariant duration of the interval between two consecutive releases.
Such observation further reveals an interesting property about the production of stops in CVCV words, namely that the relative gestural timing of the stops is independent of the voicing category of those stops (voiceless vs. voiced).

## Articulatory data

### Tongue root position

One of the known differences in supra-glottal articulation between voiced and voiceless stops concerns the position of the tongue root relative to the front-back axis of the oral tract.
It has been observed that the tongue root is more advanced in voiced than in voiceless stops [@kent1969;@perkell1969;@westbury1983].
This gesture has been interpreted as a mechanism to ensure vocal fold vibration during the closure of the stop.
The realisation of vocal fold vibration (i.e. voicing) requires the air pressure in the supra-glottal cavity to be lower than the air pressure below the glottis.
During the production of voiced obstruents, the supra-glottal pressure increases due to the immittance of air in the supra-glottal cavity.
Such pressure increase can hinder the ability to sustain voicing during closure, to the point that voicing ceases if the supra-glottal pressure is higher than the sub-glottal pressure [@ohala2011].
One of the possible articulatory solutions to counterbalance the increase in pressure during the closure of a voiced stop is to expand the pharyngeal cavity by advancing the root of the tongue [@rothenberg1967; @westbury1983].

Tongue root advancement is used idiosyncratically by the Italian and Polish speakers recorded in this study, as it can be seen in the figure below.
The position of the tongue root has been extracted from the ultrasound tongue data at the time of C2 closure onset.
In some speakers, the tongue root is more advanced at closure in voiced stops than in voiceless stops (like in IT01, IT04, PL05).
In other speakers, no difference in tongue root position can be observed (like in IT05, IT09, PL03).
Language does not play a role in the effect of voicing on tongue root position.
Furthermore, no link has been found within speakers between the magnitude of the tongue root position difference and that of the vowel duration difference.
Some speakers have a big vowel durational difference, but not much difference in tongue root position, and vice versa.
Based on this data, it looks like the voicing effect and tongue root advancement are two independent phenomena, by which their respective magnitudes are decoupled.

```{r trp-box, echo=FALSE, warning=FALSE}
duration %>%
  ggplot(aes(c2_phonation, tongue_root_z, fill = c2_phonation)) +
  geom_boxplot() +
  facet_wrap(~speaker, ncol = 9) +
  labs(
    title = "Normalised tongue root position at C2 closure onset",
    x = "C2 voicing",
    y = "Tongue root position (z-scores)"
  ) +
  scale_fill_manual(name = "C2 voicing", values = cbPalette) +
  theme(axis.text.x = element_blank())
```

Given that the difference in tongue root position (in those speakers who have one) can be observed already at consonant closure onset, it is expected that the advancing gesture of the root is initiated before closure is achieved.
This implies that the onset of the advancing gesture (relative to the position of the tongue root at vowel onset) happens during the production of the vowel, prediction born out by the data recorded in this study.
Crucially, though, the gesture is found both in vowels preceding voiced *and* voiceless stops.
Independent of language and C2 voicing, the root of the tongue starts advancing at around 50% of the vowel duration, but the magnitude of the advancement is greater in vowels followed by voiced stops.
It is not clear at this stage whether the advancing gesture found in vowels followed by voiceless stops is just a consequence of the body of the tongue raising towards the palate for the production of an oral occlusion (a non-purposive gesture, following the terminology in @rothenberg1967).
A future experiment planned for Semester II of Year 3 will be used to disambiguate between a non-purposive vs. purposive advancement gesture.
However, the relevant fact is that an enlarged cavity for voiced stops compared to voiceless stops is produced, independent of the observation that position of the root at vowel offset relative to its position at vowel onset is different both in the voiceless and voiced conditions.

### Vowel duration and tongue root position

Although the effect of voicing on vowel duration and on tongue root position are decoupled, vowel duration and tongue root position themselves are instead positively correlated.
Longer vowel durations correspond to a more advanced tongue root position, and vice versa, shorter vowel durations correspond to a less advanced tongue root.
Such correlation exists independent of the voicing of C2, fact that is compatible with the observation that advancement is produced both in vowels followed by voiceless and voiced stops.

```{r tr-lm, echo=FALSE, include=FALSE}
vow_tr_lm <- lmer(
  vowel_duration ~
    tongue_root +
    c2_phonation +
    vowel +
    syl_rate +
    (1+tongue_root|speaker) +
    (1|item),
  data = duration,
  REML = FALSE
)

vow_tr_lm_null <- lmer(
  vowel_duration ~
    c2_phonation +
    vowel +
    syl_rate +
    (1+tongue_root|speaker) +
    (1|item),
  data = duration,
  REML = FALSE
)

anova(vow_tr_lm_null, vow_tr_lm)
summary(vow_tr_lm)
```

```{r vow-tr-plot, echo=FALSE, warning=FALSE}
as_tibble(effect("tongue_root", vow_tr_lm)) %>%
  ggplot(aes(tongue_root, fit)) +
  geom_rug(
    inherit.aes = FALSE,
    data = duration,
    mapping = aes(x = tongue_root),
    alpha = 0.2
  ) +
  geom_ribbon(aes(ymax = upper, ymin = lower), fill = cbPalette[2], alpha = 0.2) +
  geom_line(colour = cbPalette[2]) +
  labs(
    title = "Correlation between tongue root position and vowel duration",
    x = "Tongue root position (mm)",
    y = "Vowel duration (ms)"
  ) +
  scale_color_manual(name = "Language", values = cbPalette)
```
