---
title: "Tracegram pilot"
author: "Stefano Coretta"
date: "08/03/2017"
output: 
  pdf_document: 
    fig_caption: yes
    latex_engine: xelatex
    number_sections: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath("../../"))
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
theme_set(theme_bw())
library(lme4)
library(effects)
library(afex)
```

# Data import

```{r data}
degg.tracing <- read_csv("./tracegram-pilot/results/results.csv") %>%
    separate(file, c("speaker", "phonation")) %>%
    mutate_if(is.character, as.factor) %>%
    mutate(phonation = factor(phonation, levels = c("modal", "breathy"))) %>%
    gather(peak, value, degg.maximum:degg.minimum)
```

# dEGG maxima and minima

```{r degg-boxplot}
ggplot(degg.tracing, aes(peak, value, colour = phonation)) +
    geom_boxplot() +
    facet_grid(. ~ speaker)
```

```{r degg-violin}
ggplot(degg.tracing, aes(peak, value, colour = phonation)) +
    geom_violin() +
    facet_grid(. ~ speaker)
```

# Tracegram plot

```{r tracegram-plot}
ggplot(degg.tracing, aes(time, value, colour = peak)) +
    geom_point(size = 0.5, alpha = 0.1) +
    geom_smooth(size = 0.5, method = "lm") +
    xlab("relative time (proportion of vowel duration)") +
    ylab("proportion of glottal period") +
    facet_grid(speaker ~ phonation) +
    ylim(0, 1)
```
